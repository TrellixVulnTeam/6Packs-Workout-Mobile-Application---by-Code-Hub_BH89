{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { Validators } from '@angular/forms';\nimport Swal from 'sweetalert2';\nimport { ChangePasswordModalPage } from '../change-password-modal/change-password-modal.page';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@ionic/angular\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"../services/user.service\";\nimport * as i5 from \"../services/data.service\";\nimport * as i6 from \"@angular/common\";\n\nfunction OldPassEntryPage_div_13_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"small\", 10);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const error_r2 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(error_r2.message);\n  }\n}\n\nfunction OldPassEntryPage_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, OldPassEntryPage_div_13_ng_container_1_Template, 3, 1, \"ng-container\", 9);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", (ctx_r0.verifyOldPassForm.controls[\"old_account_password\"].errors == null ? null : ctx_r0.verifyOldPassForm.controls[\"old_account_password\"].errors.required) && ctx_r0.verifyOldPassForm.controls[\"old_account_password\"].touched);\n  }\n}\n\nfunction OldPassEntryPage_div_18_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"small\", 10);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const error_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(error_r5.message);\n  }\n}\n\nfunction OldPassEntryPage_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, OldPassEntryPage_div_18_ng_container_1_Template, 3, 1, \"ng-container\", 9);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", (ctx_r1.verifyOldPassForm.controls[\"enter_old_password\"].errors == null ? null : ctx_r1.verifyOldPassForm.controls[\"enter_old_password\"].errors.required) && ctx_r1.verifyOldPassForm.controls[\"enter_old_password\"].touched);\n  }\n}\n\nexport let OldPassEntryPage = /*#__PURE__*/(() => {\n  class OldPassEntryPage {\n    constructor(fb, mdController, router, userService, dataService) {\n      this.fb = fb;\n      this.mdController = mdController;\n      this.router = router;\n      this.userService = userService;\n      this.dataService = dataService;\n      this.errormsgs = {\n        old_account_password: [{\n          type: 'required',\n          message: 'Enter your new password.'\n        }],\n        enter_old_password: [{\n          type: 'required',\n          message: 'Enter your new password.'\n        }, {\n          type: 'MustMatch',\n          message: 'New Password does not match.'\n        }]\n      }; // eslint-disable-next-line @typescript-eslint/member-ordering\n\n      this.submitted = false;\n    }\n\n    closeModal() {\n      this.mdController.dismiss();\n      this.router.navigate(['/tabs/home']);\n    }\n\n    ionViewDidEnter() {\n      this.userObj = this.userService.getUser();\n      console.log(this.userObj);\n      this.account_id = this.userObj.userId;\n      this.account_password = this.userObj.userPassword;\n      this.old_password = this.userObj.userPassword;\n      console.log(this.old_password);\n    }\n\n    chpwModal() {\n      return __awaiter(this, void 0, void 0, function* () {\n        const modal = yield this.mdController.create({\n          component: ChangePasswordModalPage\n        });\n        return yield modal.present();\n      });\n    }\n\n    ngOnInit() {\n      this.verifyOldPassForm = this.fb.group({\n        old_account_password: ['', [Validators.required, Validators.minLength(6), Validators.pattern('^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$ %^&*-]).{8,}$')]],\n        enter_old_password: ['', [Validators.required]]\n      }, {\n        validators: this.MustMatch('old_account_password', 'enter_old_password')\n      });\n    }\n\n    get f() {\n      return this.verifyOldPassForm.controls;\n    }\n\n    MustMatch(controlName, matchingControlName) {\n      return formGroup => {\n        const control = formGroup.controls[controlName];\n        const matchingControl = formGroup.controls[matchingControlName];\n\n        if (matchingControl.errors && !matchingControl.errors.mustMatch) {\n          return;\n        }\n\n        if (control.value !== matchingControl.value) {\n          matchingControl.setErrors({\n            mustMatch: true\n          });\n        } else {\n          matchingControl.setErrors(null);\n        }\n      };\n    }\n\n    changePassword() {\n      if (this.verifyOldPassForm.valid) {\n        Swal.fire({\n          icon: 'success',\n          title: 'User Verified!',\n          text: 'User verified. You enter the correct old password.',\n          showConfirmButton: true,\n          confirmButtonText: 'Next'\n        }).then(result => {\n          if (result.isConfirmed) {\n            this.mdController.dismiss();\n            this.router.navigate(['/change-password-modal']);\n          }\n        });\n      } else {\n        Swal.fire({\n          icon: 'error',\n          title: 'Invalid Password',\n          text: 'Incorrect old password. Please try again.',\n          showConfirmButton: true,\n          confirmButtonText: 'Close'\n        }).then(result => {\n          if (result.isConfirmed) {\n            this.mdController.dismiss();\n            this.router.navigate(['/tabs/home']);\n            this.verifyOldPassForm.reset();\n          }\n        });\n      }\n    }\n\n  }\n\n  OldPassEntryPage.ɵfac = function OldPassEntryPage_Factory(t) {\n    return new (t || OldPassEntryPage)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.ModalController), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.UserService), i0.ɵɵdirectiveInject(i5.DataService));\n  };\n\n  OldPassEntryPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: OldPassEntryPage,\n    selectors: [[\"app-old-pass-entry\"]],\n    decls: 21,\n    vars: 5,\n    consts: [[\"slot\", \"start\"], [\"icon\", \"arrow-back-outline\", \"defaultHref\", \"/tabs/home\", 3, \"click\"], [\"ngNativeValidate\", \"\", 3, \"formGroup\", \"submit\"], [\"no-lines\", \"\", 1, \"invisible-item\"], [\"position\", \"floating\"], [\"type\", \"text\", \"formControlName\", \"old_account_password\", 3, \"disabled\", \"value\"], [4, \"ngFor\", \"ngForOf\"], [\"type\", \"password\", \"formControlName\", \"enter_old_password\"], [\"type\", \"submit\", \"mode\", \"ios\", \"color\", \"success\", \"expand\", \"block\", 3, \"click\"], [4, \"ngIf\"], [1, \"error-message\"]],\n    template: function OldPassEntryPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\");\n        i0.ɵɵelementStart(1, \"ion-toolbar\");\n        i0.ɵɵelementStart(2, \"ion-buttons\", 0);\n        i0.ɵɵelementStart(3, \"ion-back-button\", 1);\n        i0.ɵɵlistener(\"click\", function OldPassEntryPage_Template_ion_back_button_click_3_listener() {\n          return ctx.closeModal();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"ion-title\");\n        i0.ɵɵtext(5, \"User Verification\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"ion-content\");\n        i0.ɵɵelementStart(7, \"form\", 2);\n        i0.ɵɵlistener(\"submit\", function OldPassEntryPage_Template_form_submit_7_listener() {\n          return ctx.changePassword();\n        });\n        i0.ɵɵelementStart(8, \"ion-list\");\n        i0.ɵɵelementStart(9, \"ion-item\", 3);\n        i0.ɵɵelementStart(10, \"ion-label\", 4);\n        i0.ɵɵtext(11, \"Old password\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(12, \"ion-input\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(13, OldPassEntryPage_div_13_Template, 2, 1, \"div\", 6);\n        i0.ɵɵelementStart(14, \"ion-item\");\n        i0.ɵɵelementStart(15, \"ion-label\", 4);\n        i0.ɵɵtext(16, \"Old password\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(17, \"ion-input\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(18, OldPassEntryPage_div_18_Template, 2, 1, \"div\", 6);\n        i0.ɵɵelementStart(19, \"ion-button\", 8);\n        i0.ɵɵlistener(\"click\", function OldPassEntryPage_Template_ion_button_click_19_listener() {\n          return ctx.changePassword();\n        });\n        i0.ɵɵtext(20, \"Verify\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"formGroup\", ctx.verifyOldPassForm);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"disabled\", true)(\"value\", ctx.old_password);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.errormsgs.old_account_password);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngForOf\", ctx.errormsgs.enter_old_password);\n      }\n    },\n    directives: [i2.IonHeader, i2.IonToolbar, i2.IonButtons, i2.IonBackButton, i2.IonBackButtonDelegate, i2.IonTitle, i2.IonContent, i1.NgControlStatusGroup, i1.FormGroupDirective, i2.IonList, i2.IonItem, i2.IonLabel, i2.IonInput, i2.TextValueAccessor, i1.NgControlStatus, i1.FormControlName, i6.NgForOf, i2.IonButton, i6.NgIf],\n    styles: [\"ion-title[_ngcontent-%COMP%]{--ion-font-family:\\\"barlow-font-lighter\\\"}a[_ngcontent-%COMP%]{float:left;position:relative;margin-left:10px}a[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px}.error-message[_ngcontent-%COMP%]{color:var(--ion-color-danger);margin-left:5px;font-size:14px;text-align:left}p[_ngcontent-%COMP%]{justify-content:left;text-align:justify;margin:15px}ion-button[_ngcontent-%COMP%]{margin-left:15px;margin-right:15px;margin-bottom:7px}.invisible-item[_ngcontent-%COMP%]{color:#fff}\"]\n  });\n  return OldPassEntryPage;\n})();","map":null,"metadata":{},"sourceType":"module"}